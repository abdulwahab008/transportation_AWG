<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard</title>
    <link rel="stylesheet" href="static/userdashboard.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="logo">
            <img src="static/images/Screenshot 2024-08-15 214832.png" alt="MOR TRANSPORT Logo">
        </div>
        <div class="profile-menu">
            <img src="static/images/profile.png" alt="Profile Picture" class="profile-pic">
            <div class="dropdown">
                <ul>
                  
                    <li><a href="./account.html">Logout</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="dashboard-container">
        <div class="dashboard-boxes">
            <div class="dashboard-box">
                <button class="box-button" id="book-vehicle">
                    <img src="static/images/pngtree-vector-car-icon-png-image_1834527.jpg" alt="Book Vehicle" class="button-icon"><br>
                    Book Your Vehicle
                </button>
            </div>
            <div class="dashboard-box">
                <button class="box-button" id="enter-complaints">
                    <img src="static/images/download.png" alt="Enter Complaints" class="button-icon"><br>
                    Enter Complaints
                </button>
            </div>
            <div class="dashboard-box">
                <button class="box-button" id="your-bookings">
                    <img src="static/images//7050939.png" alt="Your Bookings" class="button-icon"><br>
                    Your Bookings
                </button>
            </div>
        </div>
    </div>
    
        
        <div id="booking-section" style="display: none;">
            <h2>Your Bookings</h2>
            <input type="date" id="date-filter" placeholder="Filter by date">
            <div id="booking-data" class="booking-list">
              
            </div>
        </div>
    </div>

    <script>
        document.getElementById('book-vehicle').addEventListener('click', function() {
            window.location.href = 'booking.html';
        });
    
        document.getElementById('enter-complaints').addEventListener('click', function() {
            window.location.href = 'comment.html';
        });
    
        document.getElementById('your-bookings').addEventListener('click', function() {
            document.getElementById('booking-section').style.display = 'block';
       
            fetchBookings();
        });
    
        function fetchBookings() {
           
            const userId = localStorage.getItem('userId');
            
            if (!userId) {
                console.error('User ID not found. Please log in again.');
                return;
            }
    
            fetch(`/api/bookings?userId=${userId}`)
                .then(response => response.json())
                .then(data => {
                    const bookingList = document.getElementById('booking-data');
                    bookingList.innerHTML = ''; 
    
                    data.forEach(booking => {
                        const box = document.createElement('div');
                        box.className = 'booking-box';
    
                        box.innerHTML = `
                            <h3>Booking ID: ${booking.id}</h3>
                            <p><span>Name:</span> ${booking.name}</p>
                            <p><span>Email:</span> ${booking.email}</p>
                            <p><span>Vehicle Name:</span> ${booking.vehicle_name}</p>
                            <p><span>Vehicle Price:</span> ${booking.vehicle_price} SAR</p>
                            <p><span>Number of Cars:</span> ${booking.number_of_cars}</p>
                            <p><span>From:</span> ${booking.trip_from}</p>
                            <p><span>To:</span> ${booking.trip_to}</p>
                            <p><span>Days:</span> ${booking.number_of_days}</p>
                            <p><span>Date:</span> ${new Date(booking.trip_date).toLocaleString()}</p>
                            <p><span>Payment Method:</span> ${booking.payment_method}</p>
                             <p><span>transfer Amount:</span> ${booking.transfer_amount}</p>
                            <p><span>ScreenShot:</span> ${booking.payment_screenshot}</p>
                        `;
    
                        bookingList.appendChild(box);
                    });
                })
                .catch(error => {
                    console.error('Error fetching booking data:', error);
                });
        }
    </script>
</body>
</html>
